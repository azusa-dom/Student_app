import{c as y,a as H,u as O,r as g,j as e}from"./index-B6RRdl8Z.js";import{C as I}from"./chevron-right-BfVG_WxD.js";import{F as P}from"./filter-C4onsqMn.js";import{P as R}from"./plus-B9SpYxpB.js";import{C as V}from"./calendar-CF7eb6yC.js";import{C as W}from"./clock-CzrKaeqj.js";import{M as A}from"./map-pin-CmOX80xF.js";import{U as G}from"./user-BEP8z3Md.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=y("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=y("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=y("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=y("Rows3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]]),ae=()=>{const{t:n}=H(),{events:C,addEvent:S}=O(),[i,N]=g.useState(new Date),[l,u]=g.useState("month"),[h,p]=g.useState(new Date),[f,M]=g.useState(!1),[v,_]=g.useState({class_event:!0,assignment_due:!0,exam:!0,club_activity:!0}),$=()=>{const a=i.getFullYear(),t=i.getMonth(),s=new Date(a,t,1),r=new Date(a,t+1,0),d=s.getDay(),c=r.getDate(),x=[];for(let o=d-1;o>=0;o--){const m=new Date(a,t,-o);x.push({date:m,isCurrentMonth:!1})}for(let o=1;o<=c;o++){const m=new Date(a,t,o);x.push({date:m,isCurrentMonth:!0})}const j=42-x.length;for(let o=1;o<=j;o++){const m=new Date(a,t+1,o);x.push({date:m,isCurrentMonth:!1})}return x},D=()=>{const a=new Date(i);a.setDate(i.getDate()-i.getDay());const t=[];for(let s=0;s<7;s++){const r=new Date(a);r.setDate(a.getDate()+s),t.push(r)}return t},b=a=>C.filter(t=>new Date(t.start_at||t.due_at).toDateString()===a.toDateString()&&v[t.type]),w=a=>({class_event:"bg-blue-500 text-white",assignment_due:"bg-red-500 text-white",exam:"bg-purple-500 text-white",club_activity:"bg-green-500 text-white"})[a]||"bg-gray-500 text-white",E=()=>{const a=$(),t=[n("calendar.weekdays.sun"),n("calendar.weekdays.mon"),n("calendar.weekdays.tue"),n("calendar.weekdays.wed"),n("calendar.weekdays.thu"),n("calendar.weekdays.fri"),n("calendar.weekdays.sat")];return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:t.map(s=>e.jsx("div",{className:"p-3 text-center text-sm font-medium text-gray-500 bg-gray-50",children:s},s))}),e.jsx("div",{className:"grid grid-cols-7",children:a.map(({date:s,isCurrentMonth:r},d)=>{const c=b(s),x=s.toDateString()===new Date().toDateString(),j=s.toDateString()===h.toDateString();return e.jsxs("div",{className:`min-h-[120px] border-r border-b border-gray-100 p-2 cursor-pointer hover:bg-gray-50 transition-colors ${r?"":"bg-gray-50/50 text-gray-400"}`,onClick:()=>{p(new Date(s)),u("day")},children:[e.jsx("div",{className:`text-sm font-medium mb-2 ${x?"bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center":j?"bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center":""}`,children:s.getDate()}),e.jsxs("div",{className:"space-y-1",children:[c.slice(0,3).map((o,m)=>e.jsx("div",{className:`text-xs px-1.5 py-0.5 rounded truncate ${w(o.type)}`,title:o.title,children:o.title},m)),c.length>3&&e.jsx("div",{className:"text-xs text-gray-500",children:n("calendar.moreEvents",{count:c.length-3})})]})]},d)})})]})},L=()=>{const a=D(),t=Array.from({length:24},(s,r)=>r);return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-8 border-b border-gray-200",children:[e.jsx("div",{className:"p-3 bg-gray-50"}),a.map(s=>{const r=s.toDateString()===new Date().toDateString();return e.jsxs("div",{className:`p-3 text-center ${r?"bg-blue-50":"bg-gray-50"}`,children:[e.jsx("div",{className:"text-sm text-gray-500",children:s.toLocaleDateString("zh-CN",{weekday:"short"})}),e.jsx("div",{className:`text-lg font-semibold ${r?"text-blue-600":"text-gray-900"}`,children:s.getDate()})]},s.toISOString())})]}),e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-8",children:[e.jsx("div",{className:"border-r border-gray-200",children:t.map(s=>e.jsxs("div",{className:"h-16 border-b border-gray-100 p-2 text-xs text-gray-500",children:[s.toString().padStart(2,"0"),":00"]},s))}),a.map(s=>e.jsx("div",{className:"border-r border-gray-200",children:t.map(r=>{const d=b(s).filter(c=>c.start_at?new Date(c.start_at).getHours()===r:!1);return e.jsx("div",{className:"h-16 border-b border-gray-100 p-1 relative",children:d.map((c,x)=>e.jsx("div",{className:`absolute left-1 right-1 top-1 bottom-1 rounded text-xs p-1 ${w(c.type)} truncate`,title:c.title,children:c.title},x))},r)})},s.toISOString()))]})})]})},T=()=>{const a=b(h).sort((t,s)=>{const r=new Date(t.start_at||t.due_at).getTime(),d=new Date(s.start_at||s.due_at).getTime();return r-d});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:h.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"})}),e.jsx("p",{className:"text-gray-600 mt-1",children:n("calendar.eventsCount",{count:a.length})})]}),e.jsx("div",{className:"space-y-3",children:a.length===0?e.jsxs("div",{className:"bg-white rounded-xl p-8 border border-gray-200 text-center",children:[e.jsx(V,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:n("calendar.noEventsToday")})]}):a.map((t,s)=>e.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t.title}),t.course&&e.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${w(t.type)}`,children:t.course}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[t.start_at&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:new Date(t.start_at).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})})]}),t.location&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:t.location})]}),t.teacher&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:t.teacher})]})]})]})})},s))})]})},k=a=>{const t=new Date(i);l==="month"?t.setMonth(i.getMonth()+a):l==="week"?t.setDate(i.getDate()+a*7):t.setDate(i.getDate()+a),N(t),l==="day"&&p(t)},F=()=>{const a=new Date;N(a),p(a)},z=()=>{if(l==="month")return i.toLocaleDateString("zh-CN",{year:"numeric",month:"long"});if(l==="week"){const a=D(),t=a[0],s=a[6];return t.getMonth()===s.getMonth()?`${t.getFullYear()}年${t.getMonth()+1}月 ${t.getDate()}-${s.getDate()}日`:`${t.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})} - ${s.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}`}else return h.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n("calendar.title")}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>k(-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(U,{className:"w-5 h-5 text-gray-600"})}),e.jsx("button",{onClick:F,className:"px-3 py-1 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:n("calendar.today")}),e.jsx("button",{onClick:()=>k(1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(I,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:z()})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>M(!f),className:"flex items-center space-x-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:n("calendar.filter")})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>u("month"),className:`flex items-center space-x-1 px-3 py-1 rounded text-sm font-medium transition-colors ${l==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:n("calendar.month")})]}),e.jsxs("button",{onClick:()=>u("week"),className:`flex items-center space-x-1 px-3 py-1 rounded text-sm font-medium transition-colors ${l==="week"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:n("calendar.week")})]}),e.jsxs("button",{onClick:()=>u("day"),className:`flex items-center space-x-1 px-3 py-1 rounded text-sm font-medium transition-colors ${l==="day"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:n("calendar.day")})]})]}),e.jsxs("button",{onClick:()=>{const a=prompt("事件标题");if(!a)return;const t=prompt("开始时间（例如 14:00）"),[s,r]=(t||"09:00").split(":"),d=new Date(h);d.setHours(Number(s)||9,Number(r)||0,0,0),S({title:a,type:"class_event",start_at:d.toISOString()}),alert("已添加到日历")},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{children:n("calendar.addEvent")})]})]})]}),f&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:n("calendar.showEventTypes")}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:Object.entries(v).map(([a,t])=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:s=>_(r=>({...r,[a]:s.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:n(`calendar.eventTypes.${a}`)})]},a))})]})]}),l==="month"&&e.jsx(E,{}),l==="week"&&e.jsx(L,{}),l==="day"&&e.jsx(T,{})]})};export{ae as default};
