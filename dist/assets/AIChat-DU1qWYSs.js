import{a as j,r,j as t}from"./index-DX50gtMd.js";function N(){const{t:s}=j(),[g,l]=r.useState([{id:1,from:"ai",text:s?s("ai.welcome"):"Hello, I am your assistant."}]),[n,m]=r.useState(""),[x,p]=r.useState(!1),[d,f]=r.useState(""),y=e=>new Promise(i=>{setTimeout(()=>{i({text:`AI（模拟）: 我收到了“${e}”，这是一个演示回应。`})},700)}),b=async()=>{var i,u,h;if(!n.trim())return;const e={id:Date.now(),from:"user",text:n};l(a=>[...a,e]),m(""),p(!0);try{let a;if(d.trim()){const o=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:"You are a helpful assistant for students."},{role:"user",content:n}],temperature:.6})});if(!o.ok)throw new Error("OpenAI API failed");const c=await o.json();a={text:((h=(u=(i=c==null?void 0:c.choices)==null?void 0:i[0])==null?void 0:u.message)==null?void 0:h.content)||"没有回复"}}else a=await y(n);l(o=>[...o,{id:Date.now()+1,from:"ai",text:a.text}])}catch(a){l(o=>[...o,{id:Date.now()+2,from:"ai",text:"AI 服务不可用："+a.message}])}finally{p(!1)}};return t.jsxs("div",{className:"p-4 max-w-2xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-semibold mb-4",children:s("ai.title")||"AI 助手"}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:s("ai.apiKey")||"OpenAI API Key (可选)"}),t.jsx("input",{value:d,onChange:e=>f(e.target.value),className:"w-full rounded-md border px-3 py-2",placeholder:"sk-..."}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("ai.apiKeyHint")||"输入临时 key 可直接调用 OpenAI（自行承担费用），留空则使用本地模拟模式。"})]}),t.jsx("div",{className:"border rounded-lg p-3 h-80 overflow-auto bg-white/70",children:g.map(e=>t.jsx("div",{className:`mb-3 ${e.from==="ai"?"text-left":"text-right"}`,children:t.jsx("div",{className:`inline-block p-3 rounded-xl ${e.from==="ai"?"bg-gray-100 text-gray-900":"bg-blue-600 text-white"}`,children:e.text})},e.id))}),t.jsxs("div",{className:"mt-3 flex space-x-2",children:[t.jsx("input",{value:n,onChange:e=>m(e.target.value),className:"flex-1 rounded-md border px-3 py-2",placeholder:s("ai.placeholder")||"问我一些关于作业、截止日期或校园服务的问题"}),t.jsx("button",{onClick:b,disabled:x,className:"px-4 py-2 bg-indigo-600 text-white rounded-md",children:x?s("loading")||"Loading...":s("ai.send")||"发送"})]})]})}export{N as default};
