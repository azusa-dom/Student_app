import{c as y,a as H,u as O,r as g,j as e}from"./index-DNe0qmlG.js";import{C as I}from"./chevron-right-BYUGi3hd.js";import{F as P}from"./filter-Dz19tWZm.js";import{P as R}from"./plus-B-_L38Oa.js";import{C as V}from"./calendar-8zhn4ySi.js";import{C as W}from"./clock-DOaxww_7.js";import{M as A}from"./map-pin-DwW0fyp2.js";import{U as G}from"./user-BeShq4iE.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=y("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=y("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=y("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=y("Rows3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]]),ae=()=>{const{t:o}=H(),{events:C,addEvent:S}=O(),[i,f]=g.useState(new Date),[c,u]=g.useState("month"),[h,p]=g.useState(new Date),[N,M]=g.useState(!1),[D,_]=g.useState({class_event:!0,assignment_due:!0,exam:!0,club_activity:!0}),$=()=>{const s=i.getFullYear(),t=i.getMonth(),a=new Date(s,t,1),n=new Date(s,t+1,0),d=a.getDay(),l=n.getDate(),x=[];for(let r=d-1;r>=0;r--){const m=new Date(s,t,-r);x.push({date:m,isCurrentMonth:!1})}for(let r=1;r<=l;r++){const m=new Date(s,t,r);x.push({date:m,isCurrentMonth:!0})}const j=42-x.length;for(let r=1;r<=j;r++){const m=new Date(s,t+1,r);x.push({date:m,isCurrentMonth:!1})}return x},v=()=>{const s=new Date(i);s.setDate(i.getDate()-i.getDay());const t=[];for(let a=0;a<7;a++){const n=new Date(s);n.setDate(s.getDate()+a),t.push(n)}return t},b=s=>C.filter(t=>new Date(t.start_at||t.due_at).toDateString()===s.toDateString()&&D[t.type]),w=s=>({class_event:"bg-blue-500 text-white",assignment_due:"bg-red-500 text-white",exam:"bg-purple-500 text-white",club_activity:"bg-green-500 text-white"})[s]||"bg-gray-500 text-white",E=()=>{const s=$(),t=[o("calendar.weekdays.sun"),o("calendar.weekdays.mon"),o("calendar.weekdays.tue"),o("calendar.weekdays.wed"),o("calendar.weekdays.thu"),o("calendar.weekdays.fri"),o("calendar.weekdays.sat")];return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:t.map(a=>e.jsx("div",{className:"p-3 text-center text-sm font-medium text-gray-500 bg-gray-50",children:a},a))}),e.jsx("div",{className:"grid grid-cols-7",children:s.map(({date:a,isCurrentMonth:n},d)=>{const l=b(a),x=a.toDateString()===new Date().toDateString(),j=a.toDateString()===h.toDateString();return e.jsxs("div",{className:`min-h-[120px] border-r border-b border-gray-100 p-2 cursor-pointer hover:bg-gray-50 transition-colors ${n?"":"bg-gray-50/50 text-gray-400"}`,onClick:()=>{p(new Date(a)),u("day")},children:[e.jsx("div",{className:`text-sm font-medium mb-2 ${x?"bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center":j?"bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center":""}`,children:a.getDate()}),e.jsxs("div",{className:"space-y-1",children:[l.slice(0,3).map((r,m)=>e.jsx("div",{className:`text-xs px-1.5 py-0.5 rounded truncate ${w(r.type)}`,title:r.title&&typeof r.title=="object"?r.title[r.language||"zh"]||r.title.zh||r.title.en:r.title,children:r.title},m)),l.length>3&&e.jsx("div",{className:"text-xs text-gray-500",children:o("calendar.moreEvents",{count:l.length-3})})]})]},d)})})]})},L=()=>{const s=v(),t=Array.from({length:24},(a,n)=>n);return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-8 border-b border-gray-200",children:[e.jsx("div",{className:"p-3 bg-gray-50"}),s.map(a=>{const n=a.toDateString()===new Date().toDateString();return e.jsxs("div",{className:`p-3 text-center ${n?"bg-blue-50":"bg-gray-50"}`,children:[e.jsx("div",{className:"text-sm text-gray-500",children:a.toLocaleDateString("zh-CN",{weekday:"short"})}),e.jsx("div",{className:`text-lg font-semibold ${n?"text-blue-600":"text-gray-900"}`,children:a.getDate()})]},a.toISOString())})]}),e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-8",children:[e.jsx("div",{className:"border-r border-gray-200",children:t.map(a=>e.jsxs("div",{className:"h-16 border-b border-gray-100 p-2 text-xs text-gray-500",children:[a.toString().padStart(2,"0"),":00"]},a))}),s.map(a=>e.jsx("div",{className:"border-r border-gray-200",children:t.map(n=>{const d=b(a).filter(l=>l.start_at?new Date(l.start_at).getHours()===n:!1);return e.jsx("div",{className:"h-16 border-b border-gray-100 p-1 relative",children:d.map((l,x)=>e.jsx("div",{className:`absolute left-1 right-1 top-1 bottom-1 rounded text-xs p-1 ${w(l.type)} truncate`,title:l.title,children:l.title},x))},n)})},a.toISOString()))]})})]})},T=()=>{const s=b(h).sort((t,a)=>{const n=new Date(t.start_at||t.due_at).getTime(),d=new Date(a.start_at||a.due_at).getTime();return n-d});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:h.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"})}),e.jsx("p",{className:"text-gray-600 mt-1",children:o("calendar.eventsCount",{count:s.length})})]}),e.jsx("div",{className:"space-y-3",children:s.length===0?e.jsxs("div",{className:"bg-white rounded-xl p-8 border border-gray-200 text-center",children:[e.jsx(V,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:o("calendar.noEventsToday")})]}):s.map((t,a)=>e.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t.title}),t.course&&e.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${w(t.type)}`,children:t.course}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[t.start_at&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:new Date(t.start_at).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})})]}),t.location&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:t.location})]}),t.teacher&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:t.teacher})]})]})]})})},a))})]})},k=s=>{const t=new Date(i);c==="month"?t.setMonth(i.getMonth()+s):c==="week"?t.setDate(i.getDate()+s*7):t.setDate(i.getDate()+s),f(t),c==="day"&&p(t)},z=()=>{const s=new Date;f(s),p(s)},F=()=>{if(c==="month")return i.toLocaleDateString("zh-CN",{year:"numeric",month:"long"});if(c==="week"){const s=v(),t=s[0],a=s[6];return t.getMonth()===a.getMonth()?`${t.getFullYear()}年${t.getMonth()+1}月 ${t.getDate()}-${a.getDate()}日`:`${t.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})} - ${a.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}`}else return h.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:o("calendar.title")}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>k(-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(U,{className:"w-5 h-5 text-gray-600"})}),e.jsx("button",{onClick:z,className:"px-3 py-1 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:o("calendar.today")}),e.jsx("button",{onClick:()=>k(1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(I,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:F()})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>M(!N),className:"flex items-center space-x-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:o("calendar.filter")})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>u("month"),className:`flex items-center space-x-1 px-3 py-1 rounded text-sm font-medium transition-colors ${c==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:o("calendar.month")})]}),e.jsxs("button",{onClick:()=>u("week"),className:`flex items-center space-x-1 px-3 py-1 rounded text-sm font-medium transition-colors ${c==="week"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:o("calendar.week")})]}),e.jsxs("button",{onClick:()=>u("day"),className:`flex items-center space-x-1 px-3 py-1 rounded text-sm font-medium transition-colors ${c==="day"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:o("calendar.day")})]})]}),e.jsxs("button",{onClick:()=>{const s=prompt("事件标题");if(!s)return;const t=prompt("开始时间（例如 14:00）"),[a,n]=(t||"09:00").split(":"),d=new Date(h);d.setHours(Number(a)||9,Number(n)||0,0,0),S({title:s,type:"class_event",start_at:d.toISOString()}),alert("已添加到日历")},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{children:o("calendar.addEvent")})]})]})]}),N&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:o("calendar.showEventTypes")}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:Object.entries(D).map(([s,t])=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:`filter-${s}`,id:`filter-${s}`,checked:t,onChange:a=>_(n=>({...n,[s]:a.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:o(`calendar.eventTypes.${s}`)})]},s))})]})]}),c==="month"&&e.jsx(E,{}),c==="week"&&e.jsx(L,{}),c==="day"&&e.jsx(T,{})]})};export{ae as default};
