import{a as j,r,j as e}from"./index-R1Pcu--g.js";function N(){const{t:a}=j(),[g,l]=r.useState([{id:1,from:"ai",text:a?a("ai.welcome"):"Hello, I am your assistant."}]),[n,m]=r.useState(""),[p,u]=r.useState(!1),[d,y]=r.useState(""),f=t=>new Promise(o=>{setTimeout(()=>{o({text:`AI（模拟）: 我收到了“${t}”，这是一个演示回应。`})},700)}),b=async()=>{var o,x,h;if(!n.trim())return;const t={id:Date.now(),from:"user",text:n};l(s=>[...s,t]),m(""),u(!0);try{let s;if(d.trim()){const i=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:"You are a helpful assistant for students."},{role:"user",content:n}],temperature:.6})});if(!i.ok)throw new Error("OpenAI API failed");const c=await i.json();s={text:((h=(x=(o=c==null?void 0:c.choices)==null?void 0:o[0])==null?void 0:x.message)==null?void 0:h.content)||"没有回复"}}else s=await f(n);l(i=>[...i,{id:Date.now()+1,from:"ai",text:s.text}])}catch(s){l(i=>[...i,{id:Date.now()+2,from:"ai",text:"AI 服务不可用："+s.message}])}finally{u(!1)}};return e.jsxs("div",{className:"p-4 max-w-2xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:a("ai.title")||"AI 助手"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"ai-api-key",className:"block text-sm text-gray-600 mb-1",children:a("ai.apiKey")||"OpenAI API Key (可选)"}),e.jsx("input",{id:"ai-api-key",name:"ai-api-key",value:d,onChange:t=>y(t.target.value),className:"w-full rounded-md border px-3 py-2",placeholder:"sk-..."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a("ai.apiKeyHint")||"输入临时 key 可直接调用 OpenAI（自行承担费用），留空则使用本地模拟模式。"})]}),e.jsx("div",{className:"border rounded-lg p-3 h-80 overflow-auto bg-white/70",children:g.map(t=>e.jsx("div",{className:`mb-3 ${t.from==="ai"?"text-left":"text-right"}`,children:e.jsx("div",{className:`inline-block p-3 rounded-xl ${t.from==="ai"?"bg-gray-100 text-gray-900":"bg-blue-600 text-white"}`,children:t.text})},t.id))}),e.jsxs("div",{className:"mt-3 flex space-x-2",children:[e.jsx("label",{htmlFor:"ai-user-input",className:"sr-only",children:a("ai.placeholder")||"请输入问题"}),e.jsx("input",{id:"ai-user-input",name:"ai-user-input",value:n,onChange:t=>m(t.target.value),className:"flex-1 rounded-md border px-3 py-2",placeholder:a("ai.placeholder")||"问我一些关于作业、截止日期或校园服务的问题"}),e.jsx("button",{onClick:b,disabled:p,className:"px-4 py-2 bg-indigo-600 text-white rounded-md",children:p?a("loading")||"Loading...":a("ai.send")||"发送"})]})]})}export{N as default};
